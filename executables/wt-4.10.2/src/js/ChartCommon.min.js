WT_DECLARE_WT_MEMBER(2,JavaScriptConstructor,"ChartCommon",(function(t){const n=t.WT,e=this,r=n.gfxUtils,i=r.rect_top,o=r.rect_bottom,f=r.rect_left,u=r.rect_right,s=r.transform_mult;function l(t,n,e,r){let i=0;r&&(i=1);const o=n.length;function f(t){return e?n[t]:n[o-1-t]}function u(t){for(;2===f(t)[2]||3===f(t)[2];)t--;return t}let s=Math.floor(o/2);s=u(s);let l=0,h=o,c=!1;if(f(0)[i]>t)return e?-1:o;if(f(o-1)[i]<t)return e?o:-1;for(;!c;){let n=s+1;n<o&&(2===f(n)[2]||3===f(n)[2])&&(n+=2);if(f(s)[i]>t){h=s;s=Math.floor((h+l)/2);s=u(s)}else if(f(s)[i]===t)c=!0;else if(n<o&&f(n)[i]>t)c=!0;else if(n<o&&f(n)[i]===t){s=n;c=!0}else{l=s;s=Math.floor((h+l)/2);s=u(s)}}return e?s:o-1-s}function h(t,n){return n[0][t]<n[n.length-1][t]}this.findClosestPoint=function(t,n,e){let r=0;e&&(r=1);const i=h(r,n);let o=l(t,n,i,e);o<0&&(o=0);if(o>=n.length)return[n[n.length-1][0],n[n.length-1][1]];o>=n.length&&(o=n.length-2);if(n[o][r]===t)return[n[o][0],n[o][1]];let f=i?o+1:o-1;i&&2===n[f][2]&&(f+=2);if(!i&&f<0)return[n[o][0],n[o][1]];!i&&f>0&&3===n[f][2]&&(f-=2);return Math.abs(t-n[o][r])<Math.abs(n[f][r]-t)?[n[o][0],n[o][1]]:[n[f][0],n[f][1]]};this.minMaxY=function(t,n){const e=n?0:1;let r=t[0][e],i=t[0][e];for(let n=1;n<t.length;++n)if(2!==t[n][2]&&3!==t[n][2]&&5!==t[n][2]){t[n][e]>i&&(i=t[n][e]);t[n][e]<r&&(r=t[n][e])}return[r,i]};this.projection=function(t,n){const e=Math.cos(t),r=Math.sin(t),i=e*e,o=r*r,f=e*r,u=-n[0]*e-n[1]*r;return[i,f,f,o,e*u+n[0],r*u+n[1]]};this.distanceSquared=function(t,n){const e=[n[0]-t[0],n[1]-t[1]];return e[0]*e[0]+e[1]*e[1]};this.distanceLessThanRadius=function(t,n,r){return r*r>=e.distanceSquared(t,n)};this.toZoomLevel=function(t){return Math.floor(Math.log(t)/Math.LN2+.5)+1};this.isPointInRect=function(t,n){const e=t.x??t[0],r=t.y??t[1];return e>=f(n)&&e<=u(n)&&r>=i(n)&&r<=o(n)};this.toDisplayCoord=function(t,n,e,r,i){let o,f;if(e){o=[(t[0]-i[0])/i[2],(t[1]-i[1])/i[3]];f=[r[0]+o[1]*r[2],r[1]+o[0]*r[3]]}else{o=[(t[0]-i[0])/i[2],1-(t[1]-i[1])/i[3]];f=[r[0]+o[0]*r[2],r[1]+o[1]*r[3]]}return s(n,f)};this.findYRange=function(t,n,r,u,s,c,a,m,g){if(0===t.length)return null;const d=e.toDisplayCoord([r,0],[1,0,0,1,0,0],s,c,a),M=e.toDisplayCoord([u,0],[1,0,0,1,0,0],s,c,a),x=s?1:0,b=s?0:1,y=h(x,t);let C,_,p,R,D,E=l(d[x],t,y,s),L=l(M[x],t,y,s),O=1/0,T=-1/0;const A=E===L&&E===t.length||-1===E&&-1===L;if(!A){if(y)if(E<0)E=0;else{E++;t[E]&&2===t[E][2]&&(E+=2)}else E>=t.length-1&&(E=t.length-2);!y&&L<0&&(L=0);for(C=Math.min(E,L);C<=Math.max(E,L)&&C<t.length;++C)if(2!==t[C][2]&&3!==t[C][2]){t[C][b]<O&&(O=t[C][b]);t[C][b]>T&&(T=t[C][b])}if(y&&E>0||!y&&E<t.length-1){if(y){R=E-1;t[R]&&3===t[R][2]&&(R-=2)}else{R=E+1;t[R]&&2===t[R][2]&&(R+=2)}_=(d[x]-t[R][x])/(t[E][x]-t[R][x]);p=t[R][b]+_*(t[E][b]-t[R][b]);p<O&&(O=p);p>T&&(T=p)}if(y&&L<t.length-1||!y&&L>0){if(y){D=L+1;2===t[D][2]&&(D+=2)}else{D=L-1;3===t[D][2]&&(D-=2)}_=(M[x]-t[L][x])/(t[D][x]-t[L][x]);p=t[L][b]+_*(t[D][b]-t[L][b]);p<O&&(O=p);p>T&&(T=p)}}let P,S;const W=a[2]/(u-r),Y=s?2:3;if(!A){P=c[Y]/(T-O);S=10;P=c[Y]/(c[Y]/P+20);P>g.y[n]&&(P=g.y[n]);P<m.y[n]&&(P=m.y[n])}let Z;Z=s?[d[1]-i(c),A?0:(O+T)/2-c[2]/P/2-f(c)]:[d[0]-f(c),A?0:-((O+T)/2+c[3]/P/2-o(c))];return{xZoom:W,yZoom:P,panPoint:Z}};this.matchXAxis=function(t,n,e,r,s){function l(t){return r[t].side}function h(t){return r[t].width}function c(t){return r[t].minOffset}function a(t){return r[t].maxOffset}if(s){if(n<i(e)||n>o(e))return-1}else if(t<f(e)||t>u(e))return-1;for(let m=0;m<r.length;++m)if(s){if(("min"===l(m)||"both"===l(m))&&t>=f(e)-c(m)-h(m)&&t<=f(e)-c(m))return m;if(("max"===l(m)||"both"===l(m))&&t>=u(e)+a(m)&&t<=u(e)+a(m)+h(m))return m}else{if(("min"===l(m)||"both"===l(m))&&n<=o(e)+c(m)+h(m)&&n>=o(e)+c(m))return m;if(("max"===l(m)||"both"===l(m))&&n<=i(e)-a(m)&&n>=i(e)-a(m)-h(m))return m}return-1};this.matchYAxis=function(t,n,e,r,s){function l(t){return r[t].side}function h(t){return r[t].width}function c(t){return r[t].minOffset}function a(t){return r[t].maxOffset}if(s){if(t<f(e)||t>u(e))return-1}else if(n<i(e)||n>o(e))return-1;for(let m=0;m<r.length;++m)if(s){if(("min"===l(m)||"both"===l(m))&&n>=i(e)-c(m)-h(m)&&n<=i(e)-c(m))return m;if(("max"===l(m)||"both"===l(m))&&n>=o(e)+a(m)&&n<=o(e)+a(m)+h(m))return m}else{if(("min"===l(m)||"both"===l(m))&&t>=f(e)-c(m)-h(m)&&t<=f(e)-c(m))return m;if(("max"===l(m)||"both"===l(m))&&t>=u(e)+a(m)&&t<=u(e)+a(m)+h(m))return m}return-1}}));